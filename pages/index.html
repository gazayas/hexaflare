<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Hexaflare</title>

    <!-- CSS -->
    <link href="../css/application.css" rel="stylesheet" type="text/css" media="all">
    <link href="../css/progress_bar.css" rel="stylesheet" type="text/css" media="all">
  </head>
  <body>
    <!-- Change this to .container or #main_screen -->
    <div id="hexaflare">
      <div class="space stars1"></div>
      <div class="space stars2"></div>
      <div class="space stars3"></div>

      <div class="flare_star">
        <div class="core">
          <!-- The general structure for hexagons. -->
          <div class="hexagon background_hexagon inner_flare_star_hexagon" data-ring_level="0" data-value="1" data-x="0" data-y="0" data-full="false">
            <div class="hexagon_top"></div>
            <div class="hexagon_center"></div>
            <div class="hexagon_bottom"></div>
          </div>
        </div>
      </div>

      <div class="timer vertical">
        <div class="progress-bar progress-bar-info" role="progressbar" varia-valuenow="90" aria-valuemin="0" aria-valuemax="100"></div>
      </div>

      <!-- TODO: Display the next clusters here (3 to 4) -->
    </div>

    <!-- JavaScript -->
    <!-- TODO: I wanted to move everything to `application`, but it might be unneeded -->
    <script src="../javascript/application.js"></script>
    <script src="../javascript/sleep.js"></script>
    <script src="../javascript/flare_star.js"></script>
    <script src="../javascript/hexagon.js"></script>
    <script src="../javascript/mapping.js"></script>
    <script src="../javascript/gravity.js"></script>
    <script src="../javascript/collision.js"></script>
    <script src="../javascript/flare.js"></script>
    <script src="../javascript/gamepad.js"></script>
    <script src="../javascript/keyboard_buttons.js"></script>
    <script src="../javascript/progress_bar.js"></script>

    <!-- Star Clusters -->
    <script src="../javascript/star_clusters/proxima_data.js"></script>
    <script src="../javascript/star_clusters/jewel_data.js"></script>
    <script src="../javascript/star_clusters/pleiades_data.js"></script>
    <script src="../javascript/star_clusters/alpha_data.js"></script>
    <script src="../javascript/star_clusters/lambda_data.js"></script>
    <script src="../javascript/star_clusters/pi_data.js"></script>
    <script src="../javascript/star_clusters/omicron_data.js"></script>
    <script src="../javascript/star_clusters/pearl_data.js"></script>
    <script src="../javascript/star_clusters/blanco_data.js"></script>
    <script src="../javascript/star_clusters/butterfly_data.js"></script>
    <script src="../javascript/star_clusters/one_data.js"></script>
    <script src="../javascript/star_cluster.js"></script>

    <!-- <script src="../test/flare_star_test.js"></script> -->

    <script type="text/javascript">
      // In pixels
      var HEX_CENTER_WIDTH = 30
      var HEX_CENTER_HEIGHT = 18
      var HEX_TOP_BOTTOM_BORDER_HEIGHT = 7
      var HEX_INVISIBLE_BORDERS = 15 // Extends top and bottom triangles horizontally
      var HEX_TOTAL_HEIGHT = HEX_CENTER_HEIGHT + (HEX_TOP_BOTTOM_BORDER_HEIGHT * 2)
      var HEX_X_MARGIN = 4
      var HEX_Y_MARGIN = 3 // Use a negative number for greater distance
      var REAL_X = HEX_CENTER_WIDTH + HEX_X_MARGIN
      var REAL_Y = HEX_TOTAL_HEIGHT - HEX_Y_MARGIN
      var HEX_COLOR = "silver"
      var CORONA_IS_VISIBLE = false

      // Used when moving star clusters down child hexagons
      var FLIP_FACTOR = 0
      var UPDATE_TIMER = true

      var flare_star = generateFlareStar(12)
      var flare_star_ui = document.getElementsByClassName("flare_star")[0]
      generateFlareStarUI(numberOfRings(flare_star))

      var inner_flare_star_hexagons = document.getElementsByClassName("inner_flare_star_hexagon")
      for (var x = 0; x < inner_flare_star_hexagons.length; x++) {
        applyHexagonDimensions(inner_flare_star_hexagons[x], HEX_COLOR, {"inner_flare_star_hexagon_opacity": 0.3})
      }

      if(CORONA_IS_VISIBLE) {
        var corona_background_hexagons = document.getElementsByClassName("corona_hexagon")
        for (var i = 0; i < corona_background_hexagons.length; i++) {
          applyHexagonDimensions(corona_background_hexagons[i], HEX_COLOR, {"opacity": 0.075})
        }
      }

      var star_cluster_name = randomStarClusterType()
      generateStarCluster(star_cluster_name)
      var floating_cluster = document.getElementsByClassName("floating_cluster")
      generatePreviewStarCluster(floating_cluster)
      var preview_cluster = document.getElementsByClassName("preview_cluster")
      drop(preview_cluster, true)

      var frame_update_flag = 1
      function animate() {
        processTimerEvents()

        if(frame_update_flag >= 4) {
          frame_update_flag = keyboardButtonFrameUpdate()
        }
        frame_update_flag++

        if(keys_enabled) { UPDATE_TIMER = true }

        window.requestAnimationFrame(animate)
      }

      animate()
    </script>
  </body>
</html>
